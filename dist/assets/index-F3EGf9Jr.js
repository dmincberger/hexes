(function(){const d=document.createElement("link").relList;if(d&&d.supports&&d.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))n(o);new MutationObserver(o=>{for(const l of o)if(l.type==="childList")for(const i of l.addedNodes)i.tagName==="LINK"&&i.rel==="modulepreload"&&n(i)}).observe(document,{childList:!0,subtree:!0});function e(o){const l={};return o.integrity&&(l.integrity=o.integrity),o.referrerPolicy&&(l.referrerPolicy=o.referrerPolicy),o.crossOrigin==="use-credentials"?l.credentials="include":o.crossOrigin==="anonymous"?l.credentials="omit":l.credentials="same-origin",l}function n(o){if(o.ep)return;o.ep=!0;const l=e(o);fetch(o.href,l)}})();class m{constructor(d,e,n,o,l){console.log(this),this.width=d,this.height=e,this.color=n,this.clippy_path=o,this.identyfikator=l,this.createDiv()}createDiv(){this.div=document.createElement("div"),this.div.style.width=`${this.width}px`,this.div.style.height=`${this.height}px`,this.div.style.backgroundColor=this.color,this.div.style.color="white",this.div.style.position="absolute",this.div.style.clipPath="polygon(25% 0%, 75% 0%, 100% 50%, 75% 100%, 25% 100%, 0% 50%)",this.div.style.textAlign="center",this.div.style.margin="2px",this.div.id=this.identyfikator}getRoot(){return this.div}setXY(d,e){this.div.style.left=`${d}px`,this.div.style.top=`${e}px`}setText(d){this.innerHTML=d}}const T="gray";let x="clip-path: polygon(25% 0%, 75% 0%, 100% 50%, 75% 100%, 25% 100%, 0% 50%)",r=document.getElementById("size"),M=document.getElementById("plansza"),L=document.getElementById("game_items"),b=document.getElementById("load"),z=document.getElementById("save"),H=document.getElementById("json_file"),f=document.getElementById("json_text"),s;console.log(H);let t={};f.innerHTML=JSON.stringify(t,null,5);let g="WALL";t.level=[];let a=[];z.addEventListener("click",function(){const c="/saveData",d={method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(t,null,5)};fetch(c,d).then(e=>{if(!e.ok)throw new Error("Network response was not ok");return e.json()}).then(e=>{}).catch(e=>{console.error("Error during data save:",e)})});b.addEventListener("click",function(){const c="/loadData",d={method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(t,null,5)};fetch(c,d).then(e=>{if(!e.ok)throw new Error("Network response was not ok");return e.json()}).then(e=>{t=e,console.log("TO JEST LOADED DANE: ",toString(t)),f.innerHTML=JSON.stringify(t,null,5),a=[];for(let l=0;l<t.level.length;l++)a.push(t.level[l].id);r.value=t.size,M.replaceChildren();for(let l=0;l<r.value;l++){let i=l*100;for(let h=0;h<r.value;h++){let u=h*100+700,p=r.value*l+h;const v=new m(100,100,T,x,p);h%2==1&&v.setXY(u,i+60),h%2==0&&v.setXY(u,i);for(let y=0;y<t.level.length;y++)if(t.level[y].id==p){v.setText(p),v.getRoot().innerHTML=`${t.level[y].dirout}-->`;break}M.appendChild(v.getRoot())}}let n=document.querySelector("#plansza");for(let l=0;l<n.children.length;l++)n.children[l].addEventListener("click",function(){if(console.log(t),a.includes(this.id)){for(let i=0;i<t.level.length;i++)if(t.level[i].id==this.id){t.level[i].type=g,f.innerHTML=JSON.stringify(t,null,5);break}}else if(a.length==0){let i={};i.id=this.id,i.x=this.id%r.value,i.z=Math.floor(this.id/r.value),i.dirout="",i.dirin="",i.type=g,t.level.push(i),a.push(this.id),t.level.sort((h,u)=>h.id-u.id),s=i,f.innerHTML=JSON.stringify(t,null,5)}else if(Math.abs(this.id%r.value-s.x)==1&&Math.abs(Math.floor(this.id/r.value)-s.z)==0||Math.abs(this.id%r.value-s.x)==0&&Math.abs(Math.floor(this.id/r.value)-s.z)==1||Math.abs(this.id%r.value-s.x)==1&&Math.abs(Math.floor(this.id/r.value)-s.z)==1){let i={};i.id=this.id,i.x=this.id%r.value,i.z=Math.floor(this.id/r.value);let h=s.z-i.z,u=s.x-i.x;h==0&&u==-1?(i.dirout=2,i.dirin=5,this.innerHTML=`${i.dirout}^`):h==0&&u==1?(i.dirout=5,i.dirin=2,this.innerHTML=`${i.dirout}^`):h==-1&&u==0?(i.dirout=3,i.dirin=0,this.innerHTML=`${i.dirout}^`):h==-1&&u==-1?(i.dirout=2,i.dirin=5,this.innerHTML=`${i.dirout}^`):h==-1&&u==1?(i.dirout=2,i.dirin=5,this.innerHTML=`${i.dirout}^`):h==1&&u==0?(i.dirout=0,i.dirin=3,this.innerHTML=`${i.dirout}^`):h==1&&u==1?(i.dirout=5,i.dirin=2,this.innerHTML=`${i.dirout}^`):h==1&&u==-1&&(i.dirout=1,i.dirin=4,this.innerHTML=`${i.dirout}^`),i.type=g,t.level.push(i),a.push(this.id),s=i,t.level.sort((p,v)=>p.id-v.id),f.innerHTML=JSON.stringify(t,null,5)}else alert("Wybierz pole obok wybranego wcześniej!"),console.log(this.id%r.value-s.x),console.log(Math.floor(this.id/r.value)-s.z)});let o=a[a.length-1];for(let l=0;l<t.level.length;l++)if(t.level[l].id==o){s=t.level[l],console.log("LOLLFDFDFS"),console.log(s),console.log(a);break}}).catch(e=>{console.error("Error during data save:",e)})});z.value=t;for(let c=0;c<L.children.length;c++)L.children[c].addEventListener("click",function(){g=this.value});r.addEventListener("change",function(){t={},t.level=[],t.size=r.value,a=[],f.innerHTML=JSON.stringify(t,null,5),M.replaceChildren();for(let d=0;d<r.value;d++){let e=d*100;for(let n=0;n<r.value;n++){let o=n*100+700,l=r.value*d+n;const i=new m(100,100,T,x,l);n%2==1&&i.setXY(o,e+60),n%2==0&&i.setXY(o,e),console.log(n),M.appendChild(i.getRoot())}}let c=document.querySelector("#plansza");for(let d=0;d<c.children.length;d++)c.children[d].addEventListener("click",function(){if(console.log(t),a.includes(this.id)){for(let e=0;e<t.level.length;e++)if(t.level[e].id==this.id){t.level[e].type=g,f.innerHTML=JSON.stringify(t,null,5);break}}else if(a.length==0){let e={};e.id=this.id,e.x=this.id%r.value,e.z=Math.floor(this.id/r.value),e.dirout="",e.dirin="",e.type=g,t.level.push(e),a.push(this.id),t.level.sort((n,o)=>n.id-o.id),s=e,f.innerHTML=JSON.stringify(t,null,5)}else if(Math.abs(this.id%r.value-s.x)==1&&Math.abs(Math.floor(this.id/r.value)-s.z)==0||Math.abs(this.id%r.value-s.x)==0&&Math.abs(Math.floor(this.id/r.value)-s.z)==1||Math.abs(this.id%r.value-s.x)==1&&Math.abs(Math.floor(this.id/r.value)-s.z)==1){let e={};e.id=this.id,e.x=this.id%r.value,e.z=Math.floor(this.id/r.value);let n=s.z-e.z,o=s.x-e.x;n==0&&o==-1?(e.dirout=2,e.dirin=5,this.innerHTML=`${e.dirout}^`):n==0&&o==1?(e.dirout=5,e.dirin=2,this.innerHTML=`${e.dirout}^`):n==-1&&o==0?(e.dirout=3,e.dirin=0,this.innerHTML=`${e.dirout}^`):n==-1&&o==-1?(e.dirout=2,e.dirin=5,this.innerHTML=`${e.dirout}^`):n==-1&&o==1?(e.dirout=2,e.dirin=5,this.innerHTML=`${e.dirout}^`):n==1&&o==0?(e.dirout=0,e.dirin=3,this.innerHTML=`${e.dirout}^`):n==1&&o==1?(e.dirout=5,e.dirin=2,this.innerHTML=`${e.dirout}^`):n==1&&o==-1&&(e.dirout=1,e.dirin=4,this.innerHTML=`${e.dirout}^`),e.type=g,t.level.push(e),a.push(this.id),s=e,t.level.sort((l,i)=>l.id-i.id),f.innerHTML=JSON.stringify(t,null,5),this.style.transform=`rotate(${e.dirout*60}deg)`,console.log(a)}else alert("Wybierz pole obok wybranego wcześniej!"),console.log(this.id%r.value-s.x),console.log(Math.floor(this.id/r.value)-s.z)})});
